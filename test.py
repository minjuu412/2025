import streamlit as st
import random
import datetime

# ===============================
# CSS 스타일
# ===============================
st.markdown("""
<style>
/* 배경: 분홍빛 밤하늘 그라데이션 */
.stApp {
    background: linear-gradient(to bottom, #2e003e, #8e3e63, #ff6f91);
    color: #ffffff;
    overflow: hidden;
}

/* 제목 중앙 배치 + 예쁜 글자 */
.title-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 30vh;
}
.custom-title {
    font-size: 60px;
    font-weight: bold;
    text-align: center;
    background: linear-gradient(45deg, #FFD1DC, #FFB6C1, #FF69B4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
}

/* 라벨 색상 */
div[data-baseweb="select"] > label,
div[data-baseweb="datepicker"] > label {
    color: #D8BFFF !important;
    font-weight: bold;
    font-size: 20px !important;
}

/* selectbox 선택지 텍스트 색상 */
div[data-baseweb="select"] > div > div > input {
    color: #4B0082 !important;
    font-size: 18px !important;
}


/* 랜덤 스티커 */
.sticker {
    position: fixed;
    font-size: 35px;
    animation: float 6s infinite;
    opacity: 0.9;
}
@keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-25px); }
    100% { transform: translateY(0px); }
}

/* 결과값 중앙 정렬 */
.result-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    margin-top: 20px;
}
    
    st.markdown('</div>', unsafe_allow_html=True)
</style>
""", unsafe_allow_html=True)

# ===============================
# 제목 표시
# ===============================
st.markdown("""
<div class="title-container">
    <h1 class="custom-title">🌙 혈액형 & 별자리 특징 ✨</h1>
</div>
""", unsafe_allow_html=True)

# ===============================
# 랜덤 스티커 생성
# ===============================
stickers = ["🌸", "🌙", "⭐", "🦄", "🐰", "🐱", "🌈", "💖", "🍓", "✨", "🎀", "🎉", "💫", "🌼", "🍀"]
num_stickers = 20
sticker_html = ""
for _ in range(num_stickers):
    emoji = random.choice(stickers)
    top = random.randint(0, 95)
    left = random.randint(0, 95)
    delay = random.uniform(0, 5)
    sticker_html += f'<div class="sticker" style="top:{top}%; left:{left}%; animation-delay:{delay}s">{emoji}</div>'
st.markdown(sticker_html, unsafe_allow_html=True)
# -------------------- 사용자 입력 --------------------
blood_type = st.selectbox("혈액형을 선택하세요", ["A", "B", "O", "AB"])
min_date = datetime.date(1900, 1, 1)
max_date = datetime.date(2025, 12, 31)

birth_date = st.date_input(
    "생일을 선택하세요",
    value=datetime.date(2000, 1, 1),  # 기본값
    min_value=min_date,
    max_value=max_date
)

# -------------------- 별자리 계산 --------------------
def get_zodiac(month, day):
    if (month == 3 and day >= 21) or (month == 4 and day <= 19):
        return "양자리"
    elif (month == 4 and day >= 20) or (month == 5 and day <= 20):
        return "황소자리"
    elif (month == 5 and day >= 21) or (month == 6 and day <= 21):
        return "쌍둥이자리"
    elif (month == 6 and day >= 22) or (month == 7 and day <= 22):
        return "게자리"
    elif (month == 7 and day >= 23) or (month == 8 and day <= 22):
        return "사자자리"
    elif (month == 8 and day >= 23) or (month == 9 and day <= 23):
        return "처녀자리"
    elif (month == 9 and day >= 24) or (month == 10 and day <= 22):
        return "천칭자리"
    elif (month == 10 and day >= 23) or (month == 11 and day <= 22):
        return "전갈자리"
    elif (month == 11 and day >= 23) or (month == 12 and day <= 21):
        return "사수자리"
    elif (month == 12 and day >= 22) or (month == 1 and day <= 19):
        return "염소자리"
    elif (month == 1 and day >= 20) or (month == 2 and day <= 18):
        return "물병자리"
    elif (month == 2 and day >= 19) or (month == 3 and day <= 20):
        return "물고기자리"

# -------------------- 혈액형 특징 --------------------
blood_traits = {
    "A": "신중하고 꼼꼼하며 책임감이 강해요.",
    "B": "창의적이고 자유분방하며 개성이 뚜렷해요.",
    "O": "사교적이고 리더십이 있으며 에너지가 넘쳐요.",
    "AB": "이성적이면서도 감성적인 독특한 매력이 있어요."
}

# -------------------- 별자리 특징 --------------------
zodiac_traits = {
    "양자리": "도전 정신이 강하고 열정적이에요.",
    "황소자리": "끈기 있고 안정적인 성향이에요.",
    "쌍둥이자리": "호기심이 많고 다재다능해요.",
    "게자리": "가족과 친구를 소중히 여기며 따뜻해요.",
    "사자자리": "자신감이 넘치고 카리스마가 있어요.",
    "처녀자리": "분석적이고 섬세하며 현실적이에요.",
    "천칭자리": "조화를 중요시하고 매력적인 성격이에요.",
    "전갈자리": "열정적이고 직관력이 뛰어나요.",
    "사수자리": "자유롭고 낙천적인 성향이에요.",
    "염소자리": "성실하고 목표 지향적이에요.",
    "물병자리": "독창적이고 진보적인 사고를 해요.",
    "물고기자리": "감수성이 풍부하고 상상력이 뛰어나요."
}

# -------------------- 혈액형 + 별자리 조합 해석 --------------------
combo_traits = {
    # A형
    ("A", "양자리"): "신중함과 추진력이 조화를 이루어 계획적인 리더가 돼요.",
    ("A", "황소자리"): "끈기와 책임감이 강해 꾸준히 성과를 내는 타입이에요.",
    ("A", "쌍둥이자리"): "분석적이면서도 다재다능해, 공부나 연구에 강점이 있어요.",
    ("A", "게자리"): "섬세하고 배려심이 깊어 신뢰받는 친구가 돼요.",
    ("A", "사자자리"): "조직적 사고와 자신감을 겸비해 지도자로 성장할 수 있어요.",
    ("A", "처녀자리"): "세부사항에 강하고 꼼꼼해 완벽주의적 성향을 보여요.",
    ("A", "천칭자리"): "균형 잡힌 사고와 책임감으로 중재자의 역할을 잘해요.",
    ("A", "전갈자리"): "깊은 집중력과 성실함으로 어려운 문제도 해결해요.",
    ("A", "사수자리"): "도전정신에 신중함이 더해져 안정적인 모험을 즐겨요.",
    ("A", "염소자리"): "책임감과 목표 지향성이 강해 꾸준히 성공을 추구해요.",
    ("A", "물병자리"): "체계적인 사고로 새로운 아이디어를 현실화할 수 있어요.",
    ("A", "물고기자리"): "섬세한 감성과 성실함이 조화를 이루어 따뜻한 리더가 돼요.",
    # B형
    ("B", "양자리"): "활발하고 창의적인 추진력으로 활기찬 삶을 즐겨요.",
    ("B", "황소자리"): "자유로운 성향과 끈기로 독특한 성취를 만들어가요.",
    ("B", "쌍둥이자리"): "호기심과 재능이 풍부해 다양한 경험을 즐겨요.",
    ("B", "게자리"): "감성적이고 사려 깊어 주변에 긍정적 영향을 줘요.",
    ("B", "사자자리"): "자신감과 열정으로 중심인물이 되기 좋아요.",
    ("B", "처녀자리"): "창의적이면서도 꼼꼼함을 갖춘 균형형이에요.",
    ("B", "천칭자리"): "사회적 매력과 지혜로 사람들과 잘 어울려요.",
    ("B", "전갈자리"): "집중력과 직관력으로 깊이 있는 성취를 해요.",
    ("B", "사수자리"): "모험심과 자유로운 사고로 즐겁게 살아가요.",
    ("B", "염소자리"): "독창성과 성실함이 조화를 이루어 꾸준한 성취가 가능해요.",
    ("B", "물병자리"): "혁신적이고 진보적인 아이디어로 앞서나가요.",
    ("B", "물고기자리"): "감수성과 개성이 조화를 이루어 사람들에게 매력적이에요.",
    # O형
    ("O", "양자리"): "활발함과 리더십으로 주목받는 성격이에요.",
    ("O", "황소자리"): "안정감과 활력이 조화를 이루어 신뢰를 줘요.",
    ("O", "쌍둥이자리"): "다재다능하고 사교성이 뛰어나요.",
    ("O", "게자리"): "따뜻함과 에너지로 주변을 행복하게 만들어요.",
    ("O", "사자자리"): "강력한 카리스마와 추진력으로 리더 역할을 해요.",
    ("O", "처녀자리"): "체계적이면서도 활발한 성향으로 성취 가능성이 높아요.",
    ("O", "천칭자리"): "균형감과 활발함으로 사람들과 잘 어울려요.",
    ("O", "전갈자리"): "강렬한 에너지와 집중력으로 목표를 달성해요.",
    ("O", "사수자리"): "자유로움과 자신감으로 즐겁게 살아가요.",
    ("O", "염소자리"): "책임감과 추진력으로 꾸준히 성장해요.",
    ("O", "물병자리"): "독창성과 리더십으로 사람들에게 영감을 줘요.",
    ("O", "물고기자리"): "감수성과 에너지가 결합되어 매력적이에요.",
    # AB형
    ("AB", "양자리"): "이성적 판단과 열정적 추진력이 조화를 이루어요.",
    ("AB", "황소자리"): "감성과 끈기가 결합된 독창적인 성향이에요.",
    ("AB", "쌍둥이자리"): "호기심과 지혜로 다양한 경험을 즐겨요.",
    ("AB", "게자리"): "감성적이고 배려심이 풍부해 주변에 긍정적이에요.",
    ("AB", "사자자리"): "자신감과 독창성이 돋보이는 리더형이에요.",
    ("AB", "처녀자리"): "섬세하고 분석적인 사고로 성취가 높아요.",
    ("AB", "천칭자리"): "균형과 창의성이 조화를 이루어 매력적이에요.",
    ("AB", "전갈자리"): "직관과 개성이 강해 깊은 성취를 해요.",
    ("AB", "사수자리"): "자유롭고 분석적인 사고로 즐겁게 살아가요.",
    ("AB", "염소자리"): "책임감과 독창성으로 꾸준히 성장 가능해요.",
    ("AB", "물병자리"): "혁신적이고 진보적인 성향으로 영감을 줘요.",
    ("AB", "물고기자리"): "감성과 창의성이 어우러져 매력적인 성격이에요."
}

# -------------------- 48가지 잘 맞는 조합 --------------------
good_combos = {
    # A형
    ("A", "양자리"): [("O", "사자자리"), ("AB", "물병자리")],
    ("A", "황소자리"): [("B", "쌍둥이자리"), ("O", "염소자리")],
    ("A", "쌍둥이자리"): [("B", "천칭자리"), ("AB", "물병자리")],
    ("A", "게자리"): [("O", "전갈자리"), ("AB", "물고기자리")],
    ("A", "사자자리"): [("O", "양자리"), ("B", "사수자리")],
    ("A", "처녀자리"): [("B", "황소자리"), ("AB", "천칭자리")],
    ("A", "천칭자리"): [("O", "쌍둥이자리"), ("AB", "사수자리")],
    ("A", "전갈자리"): [("O", "게자리"), ("B", "물고기자리")],
    ("A", "사수자리"): [("O", "사자자리"), ("AB", "양자리")],
    ("A", "염소자리"): [("B", "황소자리"), ("O", "처녀자리")],
    ("A", "물병자리"): [("AB", "쌍둥이자리"), ("O", "천칭자리")],
    ("A", "물고기자리"): [("B", "게자리"), ("AB", "전갈자리")],
    # B형
    ("B", "양자리"): [("O", "사수자리"), ("AB", "물병자리")],
    ("B", "황소자리"): [("A", "처녀자리"), ("O", "염소자리")],
    ("B", "쌍둥이자리"): [("AB", "천칭자리"), ("O", "물병자리")],
    ("B", "게자리"): [("A", "전갈자리"), ("AB", "물고기자리")],
    ("B", "사자자리"): [("O", "양자리"), ("AB", "사수자리")],
    ("B", "처녀자리"): [("A", "황소자리"), ("O", "천칭자리")],
    ("B", "천칭자리"): [("AB", "쌍둥이자리"), ("O", "물병자리")],
    ("B", "전갈자리"): [("A", "게자리"), ("O", "물고기자리")],
    ("B", "사수자리"): [("O", "사자자리"), ("AB", "양자리")],
    ("B", "염소자리"): [("A", "황소자리"), ("O", "처녀자리")],
    ("B", "물병자리"): [("AB", "쌍둥이자리"), ("O", "천칭자리")],
    ("B", "물고기자리"): [("A", "게자리"), ("AB", "전갈자리")],
    # O형
    ("O", "양자리"): [("A", "사자자리"), ("B", "물병자리")],
    ("O", "황소자리"): [("AB", "쌍둥이자리"), ("A", "염소자리")],
    ("O", "쌍둥이자리"): [("B", "천칭자리"), ("AB", "물병자리")],
    ("O", "게자리"): [("A", "전갈자리"), ("B", "물고기자리")],
    ("O", "사자자리"): [("A", "양자리"), ("AB", "사수자리")],
    ("O", "처녀자리"): [("B", "황소자리"), ("AB", "천칭자리")],
    ("O", "천칭자리"): [("A", "쌍둥이자리"), ("B", "사수자리")],
    ("O", "전갈자리"): [("AB", "게자리"), ("A", "물고기자리")],
    ("O", "사수자리"): [("A", "사자자리"), ("B", "양자리")],
    ("O", "염소자리"): [("AB", "황소자리"), ("B", "처녀자리")],
    ("O", "물병자리"): [("A", "쌍둥이자리"), ("AB", "천칭자리")],
    ("O", "물고기자리"): [("B", "게자리"), ("A", "전갈자리")],
    # AB형
    ("AB", "양자리"): [("O", "사수자리"), ("B", "물병자리")],
    ("AB", "황소자리"): [("A", "처녀자리"), ("O", "염소자리")],
    ("AB", "쌍둥이자리"): [("B", "천칭자리"), ("O", "물병자리")],
    ("AB", "게자리"): [("A", "전갈자리"), ("B", "물고기자리")],
    ("AB", "사자자리"): [("O", "양자리"), ("A", "사수자리")],
    ("AB", "처녀자리"): [("B", "황소자리"), ("O", "천칭자리")],
    ("AB", "천칭자리"): [("A", "쌍둥이자리"), ("B", "사수자리")],
    ("AB", "전갈자리"): [("O", "게자리"), ("A", "물고기자리")],
    ("AB", "사수자리"): [("B", "사자자리"), ("O", "양자리")],
    ("AB", "염소자리"): [("A", "황소자리"), ("B", "처녀자리")],
    ("AB", "물병자리"): [("O", "쌍둥이자리"), ("A", "천칭자리")],
    ("AB", "물고기자리"): [("B", "게자리"), ("O", "전갈자리")]
}

# -------------------- 결과 출력 --------------------
if st.button("결과 보기"):
    month, day = birth_date.month, birth_date.day
    zodiac_sign = get_zodiac(month, day)

    st.subheader("✨ 결과 ✨")
    st.write(f"🩸 혈액형({blood_type}) 특징: {blood_traits[blood_type]}")
    st.write(f"🌌 별자리({zodiac_sign}) 특징: {zodiac_traits[zodiac_sign]}")
    st.write(f"🔮 조합 해석: {combo_traits[(blood_type, zodiac_sign)]}")

    # -------------------- 잘 맞는 조합 추천 --------------------
    if (blood_type, zodiac_sign) in good_combos:
        st.subheader("💖 잘 맞는 혈액형 × 별자리 조합 추천")
        matches = good_combos[(blood_type, zodiac_sign)]
        for match_blood, match_zodiac in matches:
            st.write(f"{match_blood}형 × {match_zodiac}자리")
    else:
        st.info("이 조합에 대한 추천은 준비 중이에요 😊")
        
